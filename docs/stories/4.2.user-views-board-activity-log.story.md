# Story 4.2: User Views Board Activity Log

## Status
Draft

## Story
**As a** project member,
**I want** to view the activity log for a specific board,
**so that** I can track all recent changes and events related to the project.

## Acceptance Criteria
1. An authorized user (any member of the board) can retrieve a list of all activity log entries for a specific board.
2. The activity log includes events like member invitations, role changes, task creation, and status changes within that board.
3. The activity log is ordered chronologically, with the most recent events first.
4. The API returns a paginated list of the board's activities.
5. Users who are not members of the board are prevented from viewing its activity log.

## Tasks / Subtasks
- [ ] Ensure `ActivityLogResponse` DTO is suitable for representing board-level events.
- [ ] Implement a `getBoardActivityLog` method in `ActivityLogService`. (AC: 1, 2, 3, 5)
  - [ ] Verify the user is a member of the board.
  - [ ] Query for all `ActivityLog` entities where the `boardId` matches, with pagination and chronological ordering.
  - [ ] Map the results to a list of `ActivityLogResponse` DTOs.
- [ ] Implement a `GET /projects/{boardId}/activity-log` endpoint in a new `ActivityLogController` or update `BoardController`. (AC: 1, 4, 5)
  - [ ] Secure the endpoint with JWT authentication.
  - [ ] Call `ActivityLogService.getBoardActivityLog`.
- [ ] Write unit tests for `ActivityLogService`'s `getBoardActivityLog` method.
- [ ] Write integration tests for the `GET /projects/{boardId}/activity-log` endpoint.

## Dev Notes
### Data Models
- This story will read from the `ActivityLog` table, filtering by `boardId`. The `ActivityLog` model should already include a `boardId` as specified in Story 4.1.
- [Source: architecture.md#4.7.-ActivityLog]

### API Specifications
- **Endpoint:** `GET /projects/{boardId}/activity-log`
- **Security:** Requires JWT `bearerAuth`. User must be a member of the board.
- **Path Parameters:** `boardId` (UUID).
- **Query Parameters:** `page`, `size` for pagination.
- **Responses:** 200 OK (returns paginated list of `ActivityLogResponse`), 403 Forbidden, 404 Not Found.

### Component Specifications
- **Task Management Component:** The `ActivityLogService` will be used to handle the business logic for fetching the activity log.
- [Source: architecture.md#5.4.-Task-Management-Component]

### File Locations (based on Source Tree)
- **DTO:** `backend/src/main/java/com/grupo5/taskflow/dto/ActivityLogResponse.java` (existing)
- **Service:** `backend/src/main/java/com/grupo5/taskflow/service/ActivityLogService.java` (updated)
- **Controller:** `backend/src/main/java/com/grupo5/taskflow/controller/ActivityLogController.java` (or update `BoardController`)
- [Source: architecture.md#10.-Source-Tree]

### Testing
- **Unit Tests:** Update `ActivityLogServiceTest.java`.
- **Integration Tests:** Create or update `ActivityLogControllerIntegrationTest.java`.
- [Source: architecture.md#14.-Test-Strategy-and-Standards]

## Change Log
| Date | Version | Description | Author |
| :--- | :------ | :---------- | :----- |
| 2025-11-05 | 1.0 | Initial draft of story 4.2 | Bob (Scrum Master) |

## Dev Agent Record
### Agent Model Used
{{agent_model_name_version}}

### Debug Log References

### Completion Notes List

### File List

## QA Results
