# Story 3.5: User Views Task Activity Log

## Status
Draft

## Story
**As a** project member,
**I want** to view the activity log for a specific task,
**so that** I can track its history of changes and understand its evolution.

## Acceptance Criteria
1. An authorized user (any member of the board) can retrieve a list of all activity log entries for a specific task.
2. The activity log list is ordered chronologically, with the most recent events first.
3. The API returns the paginated list of activities.
4. Users who are not members of the board cannot view the task's activity log.

## Tasks / Subtasks
- [ ] Create `ActivityLogResponse` DTO containing `eventType`, `details`, `timestamp`, and the user who performed the action.
- [ ] Implement a `getTaskActivityLog` method in `ActivityLogService`. (AC: 1, 2, 4)
  - [ ] Verify the user is a member of the board where the task resides.
  - [ ] Query for all `ActivityLog` entities for the given `cardId`, with pagination and chronological ordering.
  - [ ] Map the results to a list of `ActivityLogResponse` DTOs.
- [ ] Implement a `GET /tasks/{taskId}/activity-log` endpoint in `CardController` or a new `ActivityLogController`. (AC: 1, 3, 4)
  - [ ] Secure the endpoint with JWT authentication.
  - [ ] Call `ActivityLogService.getTaskActivityLog`.
- [ ] Write unit tests for `ActivityLogService`'s `getTaskActivityLog` method.
- [ ] Write integration tests for the `GET /tasks/{taskId}/activity-log` endpoint.

## Dev Notes
### Data Models
- This story will read from the `ActivityLog` table, filtering by `cardId`.
- [Source: architecture.md#4.7.-ActivityLog]

### API Specifications
- **Endpoint:** `GET /tasks/{taskId}/activity-log`
- **Security:** Requires JWT `bearerAuth`. User must be a member of the board.
- **Path Parameters:** `taskId` (UUID).
- **Query Parameters:** `page`, `size` for pagination.
- **Responses:** 200 OK (returns paginated list of `ActivityLogResponse`), 403 Forbidden, 404 Not Found.

### Component Specifications
- **Task Management Component:** An `ActivityLogService` will be created (if not already from another story) to handle the business logic.
- [Source: architecture.md#5.4.-Task-Management-Component]

### File Locations (based on Source Tree)
- **DTO:** `backend/src/main/java/com/grupo5/taskflow/dto/ActivityLogResponse.java`
- **Service:** `backend/src/main/java/com/grupo5/taskflow/service/ActivityLogService.java`
- **Controller:** `backend/src/main/java/com/grupo5/taskflow/controller/ActivityLogController.java` (or update `CardController`)
- [Source: architecture.md#10.-Source-Tree]

### Testing
- **Unit Tests:** Create or update `ActivityLogServiceTest.java`.
- **Integration Tests:** Create or update `ActivityLogControllerIntegrationTest.java`.
- [Source: architecture.md#14.-Test-Strategy-and-Standards]

## Change Log
| Date | Version | Description | Author |
| :--- | :------ | :---------- | :----- |
| 2025-11-05 | 1.0 | Initial draft of story 3.5 | Bob (Scrum Master) |

## Dev Agent Record
### Agent Model Used
{{agent_model_name_version}}

### Debug Log References

### Completion Notes List

### File List

## QA Results
