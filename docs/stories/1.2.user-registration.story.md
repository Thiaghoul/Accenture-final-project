# Story 1.2: User Registration

## Status
Draft

## Story
**As a** new user,
**I want** to register with my email and password,
**so that** I can get an account to access the application.

## Acceptance Criteria
1. An unauthenticated user can send a POST request with an email, password, first name, and last name to a `/auth/register` endpoint.
2. The user's password is securely hashed using BCrypt before being stored.
3. A new user record is created in the database.
4. A success response is returned after the user is created, including the new user's details (without the password hash).

## Tasks / Subtasks
- [ ] Create `User` entity (`UserModels.java`) with `id`, `email`, `passwordHash`, `firstName`, `lastName`, and `roles`. (AC: 3)
- [ ] Create `UserRepository` interface extending `JpaRepository`.
- [ ] Create `RegisterRequest` DTO with validation annotations (`@Email`, `@NotBlank`, `@Size`). (AC: 1)
- [ ] Create `UserResponse` DTO to return user details. (AC: 4)
- [ ] Implement a `register` method in `AuthService`. (AC: 2, 3)
  - [ ] Check if a user with the given email already exists.
  - [ ] Use `PasswordEncoder` (BCrypt) to hash the password.
  - [ ] Save the new `User` entity.
- [ ] Implement a `POST /auth/register` endpoint in `AuthController`. (AC: 1, 4)
  - [ ] Use `@Valid` to trigger DTO validation.
  - [ ] Call `AuthService.register`.
- [ ] Configure `PasswordEncoder` bean in `SecurityConfig`. (AC: 2)
- [ ] Write unit tests for `AuthService`'s `register` method.
- [ ] Write integration tests for the `POST /auth/register` endpoint.

## Dev Notes
### Data Models
- **User:** A new `User` entity will be created. [Source: architecture.md#4.1.-User]
- **Database Schema:** The `users` table will be created as defined in the schema. [Source: architecture.md#9.-Database-Schema]

### API Specifications
- **Endpoint:** `POST /auth/register`
- **Request Body:** `RegisterRequest` schema.
- **Responses:** 201 Created (returns `UserResponse`), 400 Bad Request (validation failed or email exists).
- [Source: architecture.md#8.-REST-API-Spec]

### Component Specifications
- **Authentication Component:** The `AuthService` will contain the core registration logic.
- **User Management Component:** The `UserRepository` will be used for data access.
- [Source: architecture.md#5.1.-Authentication-Component, architecture.md#5.2.-User-Management-Component]

### File Locations (based on Source Tree)
- **DTOs:** `.../dto/RegisterRequest.java`, `.../dto/UserResponse.java`
- **Model:** `.../model/UserModels.java`
- **Repository:** `.../repository/UserRepository.java`
- **Service:** `.../service/AuthService.java`
- **Controller:** `.../controller/AuthController.java`
- **Config:** `.../config/SecurityConfig.java`
- [Source: architecture.md#10.-Source-Tree]

### Security
- Passwords must be hashed with BCrypt. Never store plain text passwords.
- [Source: architecture.md#15.2.-Authentication-&-Authorization]

## Change Log
| Date | Version | Description | Author |
| :--- | :------ | :---------- | :----- |
| 2025-11-05 | 1.0 | Initial draft of story 1.2 | Bob (Scrum Master) |

## Dev Agent Record
### Agent Model Used
{{agent_model_name_version}}

### Debug Log References

### Completion Notes List

### File List

## QA Results
